import{a as i}from"./index-B9ygI19o.js";import{c as l,e as t,x as c,aL as p,F as h,n as b,o as a,t as d}from"./index-CqsXNJoY.js";import{_ as u}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _={name:"AdminCallsAudit",data(){return{q:"",rows:[],loading:!1}},methods:{async search(){this.loading=!0;try{const o=this.q?{q:this.q}:{},s=await i.get("/api/admin/call-webhooks",{params:o});this.rows=s.data||[]}catch(o){console.error(o)}finally{this.loading=!1}},async linkPayload(o){try{await i.post("/api/admin/link-payload",{id:o.id}),alert("Attempted link; check DB")}catch(s){console.error(s),alert("Failed")}}},created(){this.search()}},m={class:"p-6"},x={class:"mb-4"},y={key:0},k={key:1,class:"w-full table-auto border-collapse"},f={class:"border px-2"},g={class:"border px-2"},w={class:"border px-2"},v={class:"border px-2"},C={class:"border px-2"},A=["onClick"];function q(o,s,D,B,r,n){return a(),l("div",m,[s[3]||(s[3]=t("h2",{class:"text-2xl font-semibold mb-4"},"Admin - Call Webhooks Audit",-1)),t("div",x,[c(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.q=e),placeholder:"Search call_id or phone",class:"border px-2 py-1 w-80"},null,512),[[p,r.q]]),t("button",{onClick:s[1]||(s[1]=(...e)=>n.search&&n.search(...e)),class:"ml-2 px-3 py-1 bg-blue-600 text-white rounded"},"Search")]),r.loading?(a(),l("div",y,"Chargement...")):(a(),l("table",k,[s[2]||(s[2]=t("thead",null,[t("tr",null,[t("th",{class:"border px-2"},"ID"),t("th",{class:"border px-2"},"Call ID"),t("th",{class:"border px-2"},"To"),t("th",{class:"border px-2"},"Event"),t("th",{class:"border px-2"},"Actions")])],-1)),t("tbody",null,[(a(!0),l(h,null,b(r.rows,e=>(a(),l("tr",{key:e.id},[t("td",f,d(e.id),1),t("td",g,d(e.call_id),1),t("td",w,d(e.to_number),1),t("td",v,d(e.event_type),1),t("td",C,[t("button",{onClick:F=>n.linkPayload(e),class:"px-2 py-1 bg-green-600 text-white rounded"},"Link",8,A)])]))),128))])]))])}const I=u(_,[["render",q]]);export{I as default};
